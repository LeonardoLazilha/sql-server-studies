/* 
    inner join

    une duas tabelas apenas quando ha correspondencia entre elas 
    ele retorna somente os registros que tem relação em ambas as tabelas

    select
    nome_da_tabela.nome_do_campo
    nome_da_tabela.nome_do_campo
    from tabela_!
    inner join tabela_2 on
    igualdade campo em comum entre tabelas

    pode usar alias

    c.estado,
    m.data
    from movimento m
    inner join cliente c on...

*/

SELECT * FROM TABELA_DE_VENDEDORES;
SELECT * FROM NOTAS_FISCAIS;

SELECT MATRICULA, COUNT(*) AS NUMERO_NOTAS
FROM NOTAS_FISCAIS
GROUP BY MATRICULA;

SELECT NOTAS_FISCAIS.MATRICULA, TABELA_DE_VENDEDORES.NOME, COUNT(*) AS NUMERO_NOTAS
FROM  NOTAS_FISCAIS
INNER JOIN TABELA_DE_VENDEDORES ON
NOTAS_FISCAIS.MATRICULA = TABELA_DE_VENDEDORES.MATRICULA
GROUP BY NOTAS_FISCAIS.MATRICULA, TABELA_DE_VENDEDORES.NOME;

--usando alias(e boas práticas, tabela superior)
SELECT NF.MATRICULA, TV.NOME, COUNT(*) AS NUMERO_NOTAS
FROM TABELA_DE_VENDEDORES TV
INNER JOIN NOTAS_FISCAIS NF ON
NF.MATRICULA = TV.MATRICULA
GROUP BY NF.MATRICULA, TV.NOME;



-- Desafio: add o nome do produto na consulta abaixo

SELECT CODIGO_DO_PRODUTO, SUM(QUANTIDADE) AS QUANTIDADE
FROM ITENS_NOTAS_FISCAIS 
GROUP BY CODIGO_DO_PRODUTO 
HAVING SUM(QUANTIDADE) > 394000 
ORDER BY SUM(QUANTIDADE) DESC;

SELECT INF.CODIGO_DO_PRODUTO, TP.NOME_DO_PRODUTO, SUM(INF.QUANTIDADE) AS QUANTIDADE
FROM ITENS_NOTAS_FISCAIS INF
INNER JOIN TABELA_DE_PRODUTOS TP
ON INF.CODIGO_DO_PRODUTO = TP.CODIGO_DO_PRODUTO
GROUP BY INF.CODIGO_DO_PRODUTO, TP.NOME_DO_PRODUTO 
HAVING SUM(INF.QUANTIDADE) > 394000 
ORDER BY SUM(INF.QUANTIDADE) DESC;